#!/bin/bash

if [ $# -ne 3 ]; then
  echo "Usage: $0 [language] [number] [name]"
  exit 1
fi
language=$1
number=$2
name=$3

if [ $language = cpp ]; then
  ext=cpp
  rule="$number/${name}_$ext: $number/$name.$ext leetcode/assert.hpp"
  cmd='g++ $(CFLAGS) -I. -o $@ $<'
elif [ $language = rust ]; then
  ext=rs
  rule="$number/${name}_$ext: $number/$name.$ext"
  cmd='rustc -o $@ $^'
else
  echo "Error: $language is not supported."
  exit 1
fi

curdir=$(pwd)
mkdir -p $curdir/$number
cp $curdir/templates/template.$ext $number/$name.$ext
rule=$(cat << EOF
\nBINS += $number/${name}_$ext
$rule
\t$cmd
EOF
)
echo -e "$rule" >> $curdir/Makefile
